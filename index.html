<html><head><base href=".">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>CHECK LIST PROGRAMA DE GERENCIAMENTO DE RISCOS</title>
    <style>
        body {
            max-width: 95%;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            font-size: 16px;
            line-height: 1.6;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            color: #2c3e50;
        }

        .header {
            background: linear-gradient(135deg, #1976D2, #2196F3);
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 40px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.2em;
            font-weight: 700;
            letter-spacing: 0.8px;
        }

        .company-info, .environment-container, .hazard-container {
            background: white;
            padding: 35px;
            border-radius: 16px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.05);
            margin-bottom: 40px;
        }

        .form-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group label {
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 12px;
            color: #34495e;
        }

        .form-group input, 
        .form-group textarea, 
        .form-group select,
        .env-input,
        .hazard-input {
            padding: 14px 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.25s ease;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        .environment-table th,
        .hazard-table th {
            background: linear-gradient(135deg, #1976D2, #2196F3);
            padding: 18px;
            font-size: 0.95em;
        }

        table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
        }

        td, th {
            padding: 10px;
            border: 1px solid #e0e0e0;
        }

        .env-input, .hazard-input {
            width: 100%;
            box-sizing: border-box;
        }

        .hazard-container, .environment-container {
            overflow-x: auto;
            margin-bottom: 30px;
        }

        .add-row-btn {
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            padding: 14px 28px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .remove-row-btn {
            background: #ff5252;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }

        .action-button {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 200px;
            background: linear-gradient(135deg, #1976D2, #2196F3);
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        @media (max-width: 768px) {
            .form-group {
                grid-template-columns: 1fr;
            }
            
            .action-button {
                width: 100%;
                justify-content: center;
            }
            
            table {
                font-size: 14px;
            }
            
            td, th {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CHECK LIST PROGRAMA DE GERENCIAMENTO DE RISCOS</h1>
    </div>

    <div class="company-info">
        <div class="form-group">
            <label for="empresa">Empresa:</label>
            <input type="text" id="empresa" name="empresa">
        </div>
        <div class="form-group">
            <label for="unidade">Unidade:</label>
            <input type="text" id="unidade" name="unidade">
        </div>
        <div class="form-group">
            <label for="cidade">Cidade/UF:</label>
            <input type="text" id="cidade" name="cidade">
        </div>
        <div class="form-group">
            <label for="cnpj">CNPJ:</label>
            <input type="text" id="cnpj" name="cnpj">
        </div>
        <div class="form-group">
            <label for="endereco">Endere&#xe7;o:</label>
            <input type="text" id="endereco" name="endereco">
        </div>
        <div class="form-group">
            <label for="total">Quantidade de Funcion&#xe1;rios - Total:</label>
            <input type="number" id="total" name="total">
        </div>
        <div class="form-group">
            <label for="masculino">Masculino:</label>
            <input type="number" id="masculino" name="masculino">
        </div>
        <div class="form-group">
            <label for="feminino">Feminino:</label>
            <input type="number" id="feminino" name="feminino">
        </div>
        <div class="form-group">
            <label for="horario">Hor&#xe1;rio de Funcionamento:</label>
            <input type="text" id="horario" name="horario">
        </div>
        <div class="form-group">
            <label for="data">Data do Levantamento:</label>
            <input type="date" id="data" name="data">
        </div>
        <div class="form-group">
            <label for="responsavel">Nome do Resp. T&#xe9;cnico:</label>
            <input type="text" id="responsavel" name="responsavel">
        </div>
        <div class="form-group">
            <label for="registro">Assinatura/Registro Profissional:</label>
            <input type="text" id="registro" name="registro">
        </div>
        <div class="form-group">
            <label for="respAcompanhamento">Resp. pelo Acompanhamento - Nome:</label>
            <input type="text" id="respAcompanhamento" name="respAcompanhamento">
        </div>
        <div class="form-group">
            <label for="assinaturaRG">Assinatura/RG:</label>
            <input type="text" id="assinaturaRG" name="assinaturaRG">
        </div>
        <div class="form-group">
            <label for="observacoes">Observa&#xe7;&#xf5;es Gerais:</label>
            <textarea id="observacoes" name="observacoes"></textarea>
        </div>
    </div>

    <div class="environment-container">
        <h2>Descri&#xe7;&#xe3;o dos Ambientes</h2>
        <button class="add-row-btn" onclick="addEnvironmentRow()">Adicionar Ambiente</button>
        <table class="environment-table" id="environmentTable">
            <thead>
                <tr>
                    <th>Setor/Local</th>
                    <th>P&#xe9; Direito</th>
                    <th>Paredes</th>
                    <th>Piso</th>
                    <th>Cobertura</th>
                    <th>Ventila&#xe7;&#xe3;o</th>
                    <th>Ilumina&#xe7;&#xe3;o</th>
                    <th>A&#xe7;&#xf5;es</th>
                </tr>
            </thead>
            <tbody id="environmentTableBody">
                <tr>
                    <td><input type="text" name="setor[]" class="env-input"></td>
                    <td><input type="text" name="peDireito[]" class="env-input"></td>
                    <td><input type="text" name="paredes[]" class="env-input"></td>
                    <td><input type="text" name="piso[]" class="env-input"></td>
                    <td><input type="text" name="cobertura[]" class="env-input"></td>
                    <td><input type="text" name="ventilacao[]" class="env-input"></td>
                    <td><input type="text" name="iluminacao[]" class="env-input"></td>
                    <td><button class="remove-row-btn" onclick="removeEnvironmentRow(this)">Remover</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="hazard-container">
        <h2>LEVANTAMENTO DE PERIGOS E RISCOS (PREENCHER POR CARGO)</h2>
        <button class="add-row-btn" onclick="addHazardRow()">Adicionar Cargo</button>
        <table class="hazard-table" id="hazardTable">
            <thead>
                <tr>
                    <th>PERIGO</th>
                    <th>FONTES E CIRCUNST&#xc2;NCIAS (CAUSAS)</th>
                    <th>SETOR</th>
                    <th>MEDIDAS DE CONTROLE EXISTENTES</th>
                    <th>LES&#xd5;ES OU AGRAVOS &#xc0; SAUDE</th>
                    <th>FREQU&#xca;NCIA</th>
                    <th>A&#xc7;&#xd5;ES</th>
                </tr>
            </thead>
            <tbody id="hazardTableBody">
                <tr>
                    <td><input type="text" name="perigo[]" class="hazard-input"></td>
                    <td><input type="text" name="fontesCircunstancias[]" class="hazard-input"></td>
                    <td><input type="text" name="setor[]" class="hazard-input"></td>
                    <td><input type="text" name="medidasControle[]" class="hazard-input"></td>
                    <td><input type="text" name="lesoes[]" class="hazard-input"></td>
                    <td>
                        <select name="frequencia[]" class="hazard-input">
                            <option value="ocasional">Ocasional</option>
                            <option value="intermitente">Intermitente</option>
                            <option value="permanente">Permanente</option>
                        </select>
                    </td>
                    <td><button class="remove-row-btn" onclick="removeHazardRow(this)">Remover</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="hazard-container">
        <h2>EPI UTILIZADOS</h2>
        <button class="add-row-btn" onclick="addEPIRow()">Adicionar EPI</button>
        <table class="hazard-table" id="epiTable">
            <thead>
                <tr>
                    <th>EPI</th>
                    <th>CA (Certificado de Aprova&#xe7;&#xe3;o)</th>
                    <th>A&#xc7;&#xd5;ES</th>
                </tr>
            </thead>
            <tbody id="epiTableBody">
                <tr>
                    <td><input type="text" name="epi[]" class="hazard-input"></td>
                    <td><input type="text" name="ca[]" class="hazard-input"></td>
                    <td><button class="remove-row-btn" onclick="removeEPIRow(this)">Remover</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="hazard-container">
        <h2>ATIVIDADES CR&#xcd;TICAS E OUTRAS CONDI&#xc7;&#xd5;ES AMBIENTAIS</h2>
        <button class="add-row-btn" onclick="addCriticalActivityRow()">Adicionar Atividade Cr&#xed;tica</button>
        <table class="hazard-table" id="criticalActivityTable">
            <thead>
                <tr>
                    <th>CARGO</th>
                    <th>SETOR</th>
                    <th>ATIVIDADE CR&#xcd;TICA/CONDI&#xc7;&#xc3;O AMBIENTAL</th>
                    <th>A&#xe7;&#xf5;es</th>
                </tr>
            </thead>
            <tbody id="criticalActivityTableBody">
                <tr>
                    <td><input type="text" name="cargo[]" class="hazard-input"></td>
                    <td><input type="text" name="setor[]" class="hazard-input"></td>
                    <td><input type="text" name="atividadeCritica[]" class="hazard-input"></td>
                    <td><button class="remove-row-btn" onclick="removeCriticalActivityRow(this)">Remover</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="hazard-container">
        <h2>OBSERVA&#xc7;&#xd5;ES GERAIS SOBRE O CARGO</h2>
        <div class="form-group">
            <textarea id="observacoesCargo" name="observacoesCargo" style="width: 100%; min-height: 150px;"></textarea>
        </div>
    </div>

    <div class="action-buttons">
        <button class="action-button" onclick="sendReport()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
            Enviar Relat&#xf3;rio
        </button>
        <button class="action-button" onclick="saveReport()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
            </svg>
            Salvar Relat&#xf3;rio
        </button>
        <button class="action-button" onclick="generatePDF()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10 9 9 9 8 9"/>
            </svg>
            Gerar PDF
        </button>
    </div>

    <script>
        function addEnvironmentRow() {
            var table = document.getElementById("environmentTable");
            var row = table.insertRow(-1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
            var cell8 = row.insertCell(7);
            cell1.innerHTML = '<input type="text" name="setor[]" class="env-input">';
            cell2.innerHTML = '<input type="text" name="peDireito[]" class="env-input">';
            cell3.innerHTML = '<input type="text" name="paredes[]" class="env-input">';
            cell4.innerHTML = '<input type="text" name="piso[]" class="env-input">';
            cell5.innerHTML = '<input type="text" name="cobertura[]" class="env-input">';
            cell6.innerHTML = '<input type="text" name="ventilacao[]" class="env-input">';
            cell7.innerHTML = '<input type="text" name="iluminacao[]" class="env-input">';
            cell8.innerHTML = '<button class="remove-row-btn" onclick="removeEnvironmentRow(this)">Remover</button>';
        }
        function removeEnvironmentRow(row) {
            var index = row.parentNode.parentNode.rowIndex;
            document.getElementById("environmentTable").deleteRow(index);
        }
        function addHazardRow() {
            var table = document.getElementById("hazardTable");
            var row = table.insertRow(-1);
            var cells = [];
            for (var i = 0; i < 7; i++) {
                cells.push(row.insertCell(i));
            }
            cells[0].innerHTML = '<input type="text" name="perigo[]" class="hazard-input">';
            cells[1].innerHTML = '<input type="text" name="fontesCircunstancias[]" class="hazard-input">';
            cells[2].innerHTML = '<input type="text" name="setor[]" class="hazard-input">';
            cells[3].innerHTML = '<input type="text" name="medidasControle[]" class="hazard-input">';
            cells[4].innerHTML = '<input type="text" name="lesoes[]" class="hazard-input">';
            cells[5].innerHTML = '<select name="frequencia[]" class="hazard-input"><option value="ocasional">Ocasional</option><option value="intermitente">Intermitente</option><option value="permanente">Permanente</option></select>';
            cells[6].innerHTML = '<button class="remove-row-btn" onclick="removeHazardRow(this)">Remover</button>';
        }
        function removeHazardRow(row) {
            var index = row.parentNode.parentNode.rowIndex;
            document.getElementById("hazardTable").deleteRow(index);
        }
        function addEPIRow() {
            var table = document.getElementById("epiTable");
            var row = table.insertRow(-1);
            var cells = [];
            for (var i = 0; i < 3; i++) {
                cells.push(row.insertCell(i));
            }
            cells[0].innerHTML = '<input type="text" name="epi[]" class="hazard-input">';
            cells[1].innerHTML = '<input type="text" name="ca[]" class="hazard-input">';
            cells[2].innerHTML = '<button class="remove-row-btn" onclick="removeEPIRow(this)">Remover</button>';
        }
        function removeEPIRow(row) {
            var index = row.parentNode.parentNode.rowIndex;
            document.getElementById("epiTable").deleteRow(index);
        }
        function addCriticalActivityRow() {
            var table = document.getElementById("criticalActivityTable");
            var row = table.insertRow(-1);
            var cells = [];
            for (var i = 0; i < 4; i++) {
                cells.push(row.insertCell(i));
            }
            cells[0].innerHTML = '<input type="text" name="cargo[]" class="hazard-input">';
            cells[1].innerHTML = '<input type="text" name="setor[]" class="hazard-input">';
            cells[2].innerHTML = '<input type="text" name="atividadeCritica[]" class="hazard-input">';
            cells[3].innerHTML = '<button class="remove-row-btn" onclick="removeCriticalActivityRow(this)">Remover</button>';
        }
        function removeCriticalActivityRow(row) {
            var index = row.parentNode.parentNode.rowIndex;
            document.getElementById("criticalActivityTable").deleteRow(index);
        }

        function sendReport() {
            const formData = collectFormData();

            const confirmSend = confirm("Deseja enviar o relatório?");
            
            if (confirmSend) {
                try {
                    alert('Relatório enviado com sucesso!');
                    console.log('Dados do relatório:', formData);
                } catch (error) {
                    alert('Erro ao enviar relatório. Por favor, tente novamente.');
                    console.error('Erro:', error);
                }
            }
        }

        function saveReport() {
            const formData = collectFormData();
            
            try {
                const dataStr = JSON.stringify(formData, null, 2);
                
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = window.URL.createObjectURL(blob);
                const date = new Date().toISOString().split('T')[0];
                
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = `relatorio_pgr_${date}.json`;
                
                document.body.appendChild(a);
                a.click();
                
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                alert('Relatório salvo com sucesso!');
            } catch (error) {
                alert('Erro ao salvar relatório. Por favor, tente novamente.');
                console.error('Erro:', error);
            }
        }

        function generatePDF() {
            try {
                alert('Gerando PDF...');
                
                const formData = collectFormData();
                
                console.log('Dados para PDF:', formData);
                
                setTimeout(() => {
                    alert('PDF gerado com sucesso!\n\nNota: Em uma implementação real, isto baixaria um arquivo PDF.');
                }, 1000);
                
            } catch (error) {
                alert('Erro ao gerar PDF. Por favor, tente novamente.');
                console.error('Erro:', error);
            }
        }

        function collectFormData() {
            const formData = {
                dadosEmpresa: {
                    empresa: document.getElementById('empresa').value,
                    unidade: document.getElementById('unidade').value,
                    cidade: document.getElementById('cidade').value,
                    cnpj: document.getElementById('cnpj').value,
                    endereco: document.getElementById('endereco').value,
                    total: document.getElementById('total').value,
                    masculino: document.getElementById('masculino').value,
                    feminino: document.getElementById('feminino').value,
                    horario: document.getElementById('horario').value,
                    data: document.getElementById('data').value,
                    responsavel: document.getElementById('responsavel').value,
                    registro: document.getElementById('registro').value,
                    respAcompanhamento: document.getElementById('respAcompanhamento').value,
                    assinaturaRG: document.getElementById('assinaturaRG').value,
                    observacoes: document.getElementById('observacoes').value
                },
                
                ambientes: collectTableData('environmentTable'),
                perigos: collectTableData('hazardTable'),
                epis: collectTableData('epiTable'),
                atividadesCriticas: collectTableData('criticalActivityTable'),
                
                observacoesCargo: document.getElementById('observacoesCargo').value,
                
                dataGeracao: new Date().toISOString(),
                versao: '1.0'
            };

            return formData;
        }

        function collectTableData(tableId) {
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');
            const data = [];
            
            for (let i = 1; i < rows.length; i++) {
                const inputs = rows[i].getElementsByTagName('input');
                const selects = rows[i].getElementsByTagName('select');
                const rowData = {};
                
                Array.from(inputs).forEach(input => {
                    if (input.name) {
                        const cleanName = input.name.replace('[]', '');
                        rowData[cleanName] = input.value;
                    }
                });
                
                Array.from(selects).forEach(select => {
                    if (select.name) {
                        const cleanName = select.name.replace('[]', '');
                        rowData[cleanName] = select.value;
                    }
                });
                
                if (Object.keys(rowData).length > 0) {
                    data.push(rowData);
                }
            }
            
            return data;
        }
    </script>
</body>
</html>